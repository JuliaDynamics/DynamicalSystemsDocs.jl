<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/DynamicalSystemsDocs.jl/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Orbit diagrams · ChaosTools.jl</title><meta content="Orbit diagrams · ChaosTools.jl" name="title"/><meta content="Orbit diagrams · ChaosTools.jl" property="og:title"/><meta content="Orbit diagrams · ChaosTools.jl" property="twitter:title"/><meta content="Documentation for ChaosTools.jl." name="description"/><meta content="Documentation for ChaosTools.jl." property="og:description"/><meta content="Documentation for ChaosTools.jl." property="twitter:description"/><script data-outdated-warner="" src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link href="nothing/DynamicalSystemsDocs.jl/chaostools/stable/orbitdiagram/" rel="canonical"/><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../dynamicalsystems/">DynamicalSystems.jl</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Core</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../statespacesets/">StateSpaceSets.jl - numerical handling of sets in state space</a><a class="nav-link nav-item" href="../../../dynamicalsystemsbase/">DynamicalSystemsBase.jl - infrastructure for programming NLD algorithms</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Nonlinear Dynamics</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../predefineddynamicalsystems/">PredefinedDynamicalSystems.jl - predefined dynamical systems used in publications</a><a class="nav-link active nav-item" href="../../">ChaosTools.jl - various tools for analysing nonlinear and chaotic behaviour</a><a class="nav-link nav-item" href="../../../attractors/">Attractors.jl - find attractors and basins; continuation; tipping</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Nonlinear Timeseries Analysis</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../delayembeddings/">DelayEmbeddings.jl - optimal (unified/separated) delay coordinate embeddings</a><a class="nav-link nav-item" href="../../../fractaldimensions/">FractalDimensions.jl - dozens of estimators for fractal dimensions</a><a class="nav-link nav-item" href="../../../complexitymeasures/">ComplexityMeasures.jl - rigorous framework for probabilities, entropies, and other complexity measures</a><a class="nav-link nav-item" href="../../../timeseriessurrogates/">TimeseriesSurrogates.jl - dozes of ways to generate timeseries surrogates and tests hypothesis</a><a class="nav-link nav-item" href="../../../recurrenceanalysis/">RecurrenceAnalysis.jl - recurrence quantification and recurrence network analysis</a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ChaosTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">ChaosTools.jl</a></li><li class="is-active"><a class="tocitem" href="">Orbit diagrams</a><ul class="internal"><li><a class="tocitem" href="#Deterministic-iterated-map"><span>Deterministic iterated map</span></a></li><li><a class="tocitem" href="#Stroboscopic-map"><span>Stroboscopic map</span></a></li></ul></li><li><a class="tocitem" href="../lyapunovs/">Lyapunov Exponents</a></li><li><a class="tocitem" href="../chaos_detection/">Detecting &amp; Categorizing Chaos</a></li><li><a class="tocitem" href="../dimreduction/">Dimensionality reduction</a></li><li><a class="tocitem" href="../periodicity/">Fixed points &amp; Periodicity</a></li><li><a class="tocitem" href="../rareevents/">Rare events</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="">Orbit diagrams</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Orbit diagrams</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ChaosTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/main/docs/src/orbitdiagram.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Orbit-diagrams"><a class="docs-heading-anchor" href="#Orbit-diagrams">Orbit diagrams</a><a id="Orbit-diagrams-1"></a><a class="docs-heading-anchor-permalink" href="#Orbit-diagrams" title="Permalink"></a></h1><p>An orbit diagram is a way to visualize the asymptotic behaviour of a map, when a parameter of the system is changed. In practice an orbit diagram is a simple plot that plots the last <code>n</code> states of a dynamical system at a given parameter, repeated for all parameters in a range of interest. While this concept can apply to any kind of system, it makes most sense in discrete time dynamical systems. See Chapter 4 of <a href="https://link.springer.com/book/10.1007/978-3-030-91032-7">Nonlinear Dynamics</a>, Datseris &amp; Parlitz, Springer 2022, for a more involved discussion on orbit diagrams for both discrete and continuous time systems.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#ChaosTools.orbitdiagram" id="ChaosTools.orbitdiagram"><code>ChaosTools.orbitdiagram</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">orbitdiagram(ds::DynamicalSystem, i, p_index, pvalues; kwargs...) → od</code></pre><p>Compute the orbit diagram (sometimes wrongly called bifurcation diagram) of the given dynamical system, saving the <code>i</code> variable(s) for parameter values <code>pvalues</code>. The <code>p_index</code> specifies which parameter to change via <code>set_parameter!(ds, p_index, pvalue)</code>. Works for any kind of <code>DynamicalSystem</code>, although it mostly makes sense with one of <code>DeterministicIteratedMap, StroboscopicMap, PoincareMap</code>.</p><p>An orbit diagram is simply a collection of the last <code>n</code> states of <code>ds</code> as <code>ds</code> is evolved. This is done for each parameter value.</p><p><code>i</code> can be <code>Int</code> or <code>AbstractVector{Int}</code>. If <code>i</code> is <code>Int</code>, <code>od</code> is a vector of vectors. Else <code>od</code> is a vector of vectors of vectors. Each entry od <code>od</code> are the points at each parameter value, so that <code>length(od) == length(pvalues)</code> and <code>length(od[j]) == n, ∀ j</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>n::Int = 100</code>: Amount of points to save for each parameter value.</li><li><code>Δt = 1</code>: Stepping time between saving points.</li><li><code>u0 = nothing</code>: Specify an initial state. If <code>nothing</code>, the previous state after each parameter is used to seed the new initial condition at the new parameter (with the very first state being the system's state). This makes convergence to the attractor faster, necessitating smaller <code>Ttr</code>. Otherwise <code>u0</code> can be a standard state, or a vector of states, so that a specific state is used for each parameter.</li><li><code>Ttr::Int = 10</code>: Each orbit is evolved for <code>Ttr</code> first before saving output.</li><li><code>ulims = (-Inf, Inf)</code>: only record system states within <code>ulims</code> (only valid if <code>i isa Int</code>). Iteration continues until <code>n</code> states fall within <code>ulims</code>.</li><li><code>show_progress = false</code>: Display a progress bar (counting the parameter values).</li><li><code>periods = nothing</code>: Only valid if <code>ds isa StroboscopicMap</code>. If given, it must be a a container with same layout as <code>pvalues</code>. Provides a value for the <code>period</code> for each parameter value. Useful in case the orbit diagram is produced versus a driving frequency.</li></ul></div><a class="docs-sourcelink" href="https://github.com/JuliaDynamics/ChaosTools.jl/blob/14adea9caedd6fa64f371d6e76851de214e7b498/src/timeevolution/orbitdiagram.jl#L4-L38" target="_blank">source</a></section></article><h2 id="Deterministic-iterated-map"><a class="docs-heading-anchor" href="#Deterministic-iterated-map">Deterministic iterated map</a><a id="Deterministic-iterated-map-1"></a><a class="docs-heading-anchor-permalink" href="#Deterministic-iterated-map" title="Permalink"></a></h2><p>For example, let's compute the famous orbit diagram of the logistic map:</p><pre><code class="language-julia hljs">using ChaosTools, CairoMakie

logistic_rule(x, p, n) = @inbounds SVector(p[1]*x[1]*(1-x[1]))
logistic = DeterministicIteratedMap(logistic_rule, [0.4], [4.0])

i = 1
parameter = 1
pvalues = 2.5:0.004:4
n = 2000
Ttr = 2000
output = orbitdiagram(logistic, i, parameter, pvalues; n, Ttr)

L = length(pvalues)
x = Vector{Float64}(undef, n*L)
y = copy(x)
for j in 1:L
    x[(1 + (j-1)*n):j*n] .= pvalues[j]
    y[(1 + (j-1)*n):j*n] .= output[j]
end

fig, ax = scatter(x, y; axis = (xlabel = L"r", ylabel = L"x"),
    markersize = 0.8, color = ("black", 0.05),
)
ax.title = "Logistic map orbit diagram"
xlims!(ax, pvalues[1], pvalues[end]); ylims!(ax,0,1)
fig</code></pre><img alt="Example block output" src="4c554406.png"/><h2 id="Stroboscopic-map"><a class="docs-heading-anchor" href="#Stroboscopic-map">Stroboscopic map</a><a id="Stroboscopic-map-1"></a><a class="docs-heading-anchor-permalink" href="#Stroboscopic-map" title="Permalink"></a></h2><p>The beauty of <a href="#ChaosTools.orbitdiagram"><code>orbitdiagram</code></a> is that it can be directly applied to any kind of <code>DynamicalSystem</code>. The most useful cases are the already seen <code>DeterministicIteratedMap</code>, but also <a href="../#DynamicalSystemsBase.PoincareMap"><code>PoincareMap</code></a> and <a href="../#DynamicalSystemsBase.StroboscopicMap"><code>StroboscopicMap</code></a>. Here is an example of the orbit diagram for the Duffing oscillator (making the same as Figure 9.2 of  <a href="https://link.springer.com/book/10.1007/978-3-030-91032-7">Nonlinear Dynamics</a>, Datseris &amp; Parlitz, Springer 2022).</p><pre><code class="language-julia hljs">using ChaosTools, CairoMakie

function duffing_rule(u,p,t)
    d, a, ω = p
    du1 =  u[2]
    du2 =  -u[1] - u[1]*u[1]*u[1] - d*u[2] + a*sin(ω*t)
    return SVector(du1, du2)
end
T0 = 25.0
p0 = [0.1, 7, 2π/T0]
u0 = [1.1, 1.1]
ds = CoupledODEs(duffing_rule, u0, p0)
duffing = StroboscopicMap(ds, T0)

# We want to change both the parameter `ω`, but also the
# period of the stroboscopic map. `orbitdiagram` allows this!
Trange = range(8, 26; length = 201)
ωrange = @. 2π / Trange
n = 200
output = orbitdiagram(duffing, 1, 3, ωrange; n, u0, Ttr = 100, periods = Trange)

L = length(Trange)
x = Vector{Float64}(undef, n*L)
y = copy(x)
for j in 1:L
    x[(1 + (j-1)*n):j*n] .= Trange[j]
    y[(1 + (j-1)*n):j*n] .= output[j]
end

fig, ax = scatter(x, y; axis = (xlabel = L"T", ylabel = L"u_1"),
    markersize = 8, color = ("blue", 0.25),
)
ylims!(ax, -1, 1)
fig</code></pre><img alt="Example block output" src="e1c2d085.png"/><p><em>Pro tip: to actually make Fig. 9.2 you'd have to do two modifications: first, pass <code>periods = Trange ./ 2</code>, so that points are recorded every half period. Then, at the very end, do <code>y[2:2:end] .= -y[2:2:end]</code> so that the symmetric orbits are recorded as well</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« ChaosTools.jl</a><a class="docs-footer-nextpage" href="../lyapunovs/">Lyapunov Exponents »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Saturday 23 March 2024 09:33">Saturday 23 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>
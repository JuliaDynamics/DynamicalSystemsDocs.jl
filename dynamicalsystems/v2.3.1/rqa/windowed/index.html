<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/'</script><script charset="utf-8" src="../../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Windowed RQA · DynamicalSystems.jl</title><script data-outdated-warner="" src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../../assets/themeswap.js"></script><link href="../../assets/logo.ico" rel="icon" type="image/x-icon"/><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link href="../../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><a class="nav-link active nav-item" href="../../../">DynamicalSystems.jl</a><div class="nav-dropdown"><button class="nav-item dropdown-label">colname</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../../statespacesets/">StateSpaceSets.jl</a><a class="nav-link nav-item" href="../../../../dynamicalsystemsbase/">DynamicalSystemsBase.jl</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">colname</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../../predefineddynamicalsystems/">PredefinedDynamicalSystems.jl</a><a class="nav-link nav-item" href="../../../../chaostools/">ChaosTools.jl</a><a class="nav-link nav-item" href="../../../../attractors/">Attractors.jl</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">colname</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../../delayembeddings/">DelayEmbeddings.jl</a><a class="nav-link nav-item" href="../../../../fractaldimensions/">FractalDimensions.jl</a><a class="nav-link nav-item" href="../../../../complexitymeasures/">ComplexityMeasures.jl</a><a class="nav-link nav-item" href="../../../../timeseriessurrogates/">TimeseriesSurrogates.jl</a><a class="nav-link nav-item" href="../../../../recurrenceanalysis/">RecurrenceAnalysis.jl</a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img alt="DynamicalSystems.jl logo" src="../../assets/logo.png"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DynamicalSystems.jl</a></span></div><form action="../../search/" class="docs-search"><input class="docs-search-query" id="documenter-search-query" name="q" placeholder="Search docs" type="text"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../contents/">Contents</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Dynamical systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../ds/general/">Dynamical System Definition</a></li><li><a class="tocitem" href="../../ds/predefined/">Predefined Dynamical Systems</a></li><li><a class="tocitem" href="../../embedding/dataset/">Numerical Data</a></li><li><a class="tocitem" href="../../ds/integrators/">Integrators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">DelayEmbeddings</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../embedding/reconstruction/">Delay Coordinates Embedding</a></li><li><a class="tocitem" href="../../embedding/traditional/">Traditional Optimal Embedding</a></li><li><a class="tocitem" href="../../embedding/unified/">Unified Optimal Embedding</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Entropies</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../entropies/api/">Entropies &amp; Probabilities</a></li><li><a class="tocitem" href="../../entropies/estimators/">Probabilities Estimators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">ChaosTools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../chaos/orbitdiagram/">Orbit Diagrams &amp; PSOS</a></li><li><a class="tocitem" href="../../chaos/lyapunovs/">Lyapunov Exponents</a></li><li><a class="tocitem" href="../../chaos/chaos_detection/">Detecting &amp; Categorizing Chaos</a></li><li><a class="tocitem" href="../../chaos/fractaldim/">Fractal Dimension</a></li><li><a class="tocitem" href="../../chaos/nlts/">Nonlinear Timeseries Analysis</a></li><li><a class="tocitem" href="../../chaos/periodicity/">Fixed points &amp; Periodicity</a></li><li><a class="tocitem" href="../../chaos/basins/">Attractors, Basins, Tipping Points</a></li></ul></li><li><input checked="" class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">RecurrenceAnalysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../rplots/">Recurrence Plots</a></li><li><a class="tocitem" href="../quantification/">Recurrence Quantification Analysis</a></li><li class="is-active"><a class="tocitem" href="">Windowed RQA</a><ul class="internal"><li><a class="tocitem" href="#Docstring"><span>Docstring</span></a></li><li><a class="tocitem" href="#Alternative-syntax-for-@windowed"><span>Alternative syntax for <code>@windowed</code></span></a></li></ul></li><li><a class="tocitem" href="../networks/">Recurrence Networks</a></li></ul></li><li><a class="tocitem" href="../../dynamicalsystems_interactive/">Interactive GUIs</a></li><li><a class="tocitem" href="../../contributors_guide/">Contributor Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">RecurrenceAnalysis</a></li><li class="is-active"><a href="">Windowed RQA</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Windowed RQA</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/DynamicalSystems.jl/blob/main/docs/src/rqa/windowed.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a></div></header><article class="content" id="documenter-page"><h1 id="Windowed-RQA"><a class="docs-heading-anchor" href="#Windowed-RQA">Windowed RQA</a><a id="Windowed-RQA-1"></a><a class="docs-heading-anchor-permalink" href="#Windowed-RQA" title="Permalink"></a></h1><p>In some cases, specially with very long time series, it may be suitable to perform the analysis at different points, considering only a limited <em>window</em> of data around each observation. The macro <a href="#RecurrenceAnalysis.@windowed"><code>@windowed</code></a> modifies the behaviour of the basic functions to calculate RQA parameters in that fashion. For instance, if <code>rmat</code> is a 10&lt;sup&gt;4&lt;/sup&gt;&amp;times;10&lt;sup&gt;4&lt;/sup&gt; recurrence matrix, then</p><pre><code class="language-julia hljs">@windowed determinism(rmat, theiler=2, lmin=3) width=1000 step=100</code></pre><p>will return a 91-element vector, such that each value is the determinism associated to a 1000-point fragment, starting at every 100 points (i.e. at <code>1</code>, <code>101</code>, &amp;hellip; <code>9001</code>).</p><p>The general syntax of that macro is:</p><pre><code class="language-julia hljs">@windowed expr w                 #1
@windowed expr width=w step=s    #2</code></pre><p>where:</p><ul><li><code>expr</code> is an expression used to calculate RQA parameters</li><li><code>w</code> is the width of the window for relevant data around each point.</li><li><code>s</code> is the step or distance between points where the calculations are done (starting in the first point).</li></ul><p>To prevent syntax failures in the expansion of the macro, identify the RQA function (<code>rqa</code>, <code>recurrencerate</code>, <code>determinism</code>,...) directly by its name (avoid aliases), and use simple variable names (not complex expressions) for the arguments. On the other hand, the windowing options <code>width</code> and <code>step</code> can be given in any order. If <code>step</code> is omitted, the calculations are done at every point, and the keyword <code>width</code> may be omitted. (However, using <code>step=1</code> may be computationally very expensive, and that will provide just overly redundant results around each point, so it is advisable to set <code>step</code> a relatively big fraction of the window <code>width</code>.)</p><p>The value returned by the macro will normally be a vector with the same type of numbers as expected by <code>expr</code>. In the case of <code>@windowed rqa(...) ...</code>, it will return a NamedTuple with a similar structure as in the default <code>rqa</code> function, but replacing scalar values by vectors.</p><p>The macro <code>@windowed</code> can also be applied to the functions that calculate recurrence matrices (<code>RecurrenceMatrix</code>, <code>CrossRecurrenceMatrix</code>, <code>JointRecurrenceMatrix</code>). That creates a sparse matrix with the same size as if the macro was not used, but only containing valid values for pairs of points that belong to the <code>w</code> first main diagonals (i.e. the separation in time from one point to the other is <code>w</code> or smaller). The &amp;lsquo;step&amp;rsquo; parameter <code>s</code> has no effect on those functions. Such &amp;lsquo;windowed&amp;rsquo; matrices can be used as the input arguments to calculate windowed RQA parameters, obtaining the same results as if the complete matrix was used (under certain conditions, see below). For instance, the following calculations are equivalent:</p><pre><code class="language-julia hljs"># Using complete matrix
rmat = RecurrenceMatrix(x, 1.5)
d = @windowed determinism(rmat) width=1000 step=250

# Using windowed matrix
rmatw = @windowed RecurrenceMatrix(x, 1.5) 1000
d = @windowed determinism(rmatw) width=1000 step=250</code></pre><p>The main difference between the two alternatives is that the second one will be faster and consume less memory. To ensure the equivalence between both approaches, the window width used to create the matrix must be greater than the one used to calculate the RQA parameters. Otherwise, the computation of RQA parameters might involve data points whose value is not well defined. Besides, the threshold to identify recurrences should be referred to a fixed scale. For instance:</p><pre><code class="language-julia hljs">rmat  =           RecurrenceMatrix(x, 0.1, scale=maximum)
rmatw = @windowed RecurrenceMatrix(x, 0.1, scale=maximum) 1000
rmat[1:1000,1:1000] == rmatw[1:1000,1:1000] # FALSE!!!</code></pre><p>In this example, the <code>1000×1000</code> blocks of both matrices differ, because the threshold <code>0.1</code> is scaled with respect to the maximum distance between all points of <code>x</code> in <code>rmat</code>, but in the case of <code>rmatw</code> the scale changes between subsets of points. Something similar may happen if the recurrence matrix is calculated for a fixed recurrence rate (with the option <code>fixedrate=true</code>).</p><h2 id="Docstring"><a class="docs-heading-anchor" href="#Docstring">Docstring</a><a id="Docstring-1"></a><a class="docs-heading-anchor-permalink" href="#Docstring" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" href="#RecurrenceAnalysis.@windowed" id="RecurrenceAnalysis.@windowed"><code>RecurrenceAnalysis.@windowed</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@windowed(f(x,...), width)
@windowed(f(x,...); width, step=1)</code></pre><p>Calculate windowed RQA parameters with a given window width.</p><p><code>f(x,...)</code> may be any call to RQA functions (e.g. <a href="../quantification/#RecurrenceAnalysis.recurrencerate"><code>recurrencerate</code></a>, <a href="../quantification/#RecurrenceAnalysis.determinism"><code>determinism</code></a>, etc.), with <code>x</code> being a named variable that designates the recurrence matrix (do not use in-place calculations of the recurrence matrix). The results are returned in a vector with one value for each position of the window. By default the window moves at one-point intervals, but a longer <code>step</code> length may be specified, together with the window <code>width</code>, by declaring those options as keyword arguments.</p><p>This macro may be also used with recurrence matrix constructors (<code>RecurrenceMatrix</code>, <code>CrossRecurrenceMatrix</code>, <code>JointRecurrenceMatrix</code>), to create 'incomplete' matrices that are suitable for such windowed RQA. The values of the resulting matrix in the diagonals within the window width will be equal to those obtained without the <code>@windowed</code> macro, if the distances are not scaled (using the option <code>scale=1</code>, see <a href="../rplots/#RecurrenceAnalysis.RecurrenceMatrix"><code>RecurrenceMatrix</code></a>). Outside the window width, the values of the recurrence matrix will be undefined (mostly zero).</p></div></section></article><h2 id="Alternative-syntax-for-@windowed"><a class="docs-heading-anchor" href="#Alternative-syntax-for-@windowed">Alternative syntax for <code>@windowed</code></a><a id="Alternative-syntax-for-@windowed-1"></a><a class="docs-heading-anchor-permalink" href="#Alternative-syntax-for-@windowed" title="Permalink"></a></h2><p>The following ways of using the macro <code>@windowed</code> are equivalent:</p><pre><code class="language-julia hljs">y = @windowed f(x,...) w
@windowed y=f(x,...) w
y = @windowed(f(x,...), w)
@windowed(y=f(x,...), w)</code></pre><p>In all four cases, the width parameter <code>w</code> might have been qualified with a keyword as <code>width=w</code>. If the step parameter is added, the keyword qualification is mandatory.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../quantification/">« Recurrence Quantification Analysis</a><a class="docs-footer-nextpage" href="../networks/">Recurrence Networks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 19 October 2022 14:46">Wednesday 19 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>
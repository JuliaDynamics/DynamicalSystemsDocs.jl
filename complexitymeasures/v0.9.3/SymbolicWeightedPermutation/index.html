<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/DynamicalSystemsDocs.jl/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Weighted permutation (symbolic) · Entropies.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link href="nothing/DynamicalSystemsDocs.jl/complexitymeasures/stable/SymbolicWeightedPermutation/" rel="canonical"/><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../dynamicalsystems/">DynamicalSystems.jl</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Core</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../statespacesets/">StateSpaceSets.jl - numerical handling of sets in state space</a><a class="nav-link nav-item" href="../../../dynamicalsystemsbase/">DynamicalSystemsBase.jl - infrastructure for programming NLD algorithms</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Nonlinear Dynamics</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../predefineddynamicalsystems/">PredefinedDynamicalSystems.jl - predefined dynamical systems used in publications</a><a class="nav-link nav-item" href="../../../chaostools/">ChaosTools.jl - various tools for analysing nonlinear and chaotic behaviour</a><a class="nav-link nav-item" href="../../../attractors/">Attractors.jl - find attractors and basins; continuation; tipping</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Nonlinear Timeseries Analysis</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../delayembeddings/">DelayEmbeddings.jl - optimal (unified/separated) delay coordinate embeddings</a><a class="nav-link nav-item" href="../../../fractaldimensions/">FractalDimensions.jl - dozens of estimators for fractal dimensions</a><a class="nav-link active nav-item" href="../../">ComplexityMeasures.jl - rigorous framework for probabilities, entropies, and other complexity measures</a><a class="nav-link nav-item" href="../../../timeseriessurrogates/">TimeseriesSurrogates.jl - dozes of ways to generate timeseries surrogates and tests hypothesis</a><a class="nav-link nav-item" href="../../../recurrenceanalysis/">RecurrenceAnalysis.jl - recurrence quantification and recurrence network analysis</a><a class="nav-link nav-item" href="../../../transitionsintimeseries/">TransitionsInTimeseries.jl - identify transitions / regime shifts / change points in timeseries</a><a class="nav-link nav-item" href="../../../signaldecomposition/">SignalDecomposition.jl - decompose timeseries into components such as noise+signal or periodic+aperiodic or trend+residual</a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Entropies.jl</span></div><form action="../search/" class="docs-search"><input class="docs-search-query" id="documenter-search-query" name="q" placeholder="Search docs" type="text"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Entropies.jl</a></li><li><span class="tocitem">Estimators</span><ul><li><a class="tocitem" href="../CountOccurrences/">CountOccurrences (counting)</a></li><li><a class="tocitem" href="../VisitationFrequency/">Visitation frequency (binning)</a></li><li><a class="tocitem" href="../SymbolicPermutation/">Permutation (symbolic)</a></li><li class="is-active"><a class="tocitem" href="">Weighted permutation (symbolic)</a></li><li><a class="tocitem" href="../SymbolicAmplitudeAwarePermutation/">Amplitude-aware permutation (symbolic)</a></li><li><a class="tocitem" href="../NearestNeighbors/">Nearest neighbor estimators</a></li><li><a class="tocitem" href="../NaiveKernel/">Kernel density</a></li><li><a class="tocitem" href="../TimeScaleMODWT/">Time-scale (wavelet)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Estimators</a></li><li class="is-active"><a href="">Weighted permutation (symbolic)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Weighted permutation (symbolic)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/Entropies.jl/blob/master/docs/src/SymbolicWeightedPermutation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a></div></header><article class="content" id="documenter-page"><h1 id="Weighted-permutation-(symbolic)"><a class="docs-heading-anchor" href="#Weighted-permutation-(symbolic)">Weighted permutation (symbolic)</a><a id="Weighted-permutation-(symbolic)-1"></a><a class="docs-heading-anchor-permalink" href="#Weighted-permutation-(symbolic)" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" href="#Entropies.SymbolicWeightedPermutation" id="Entropies.SymbolicWeightedPermutation"><code>Entropies.SymbolicWeightedPermutation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SymbolicWeightedPermutation(; τ = 1, m = 3) &lt;: PermutationProbabilityEstimator</code></pre><p>A symbolic, weighted permutation based probabilities/entropy estimator.</p><p><strong>Properties of original signal preserved</strong></p><p>Weighted permutations of a signal preserve not only ordinal patterns (sorting information), but also encodes amplitude information. This implementation is based on Fadlallah et al. (2013)<sup class="footnote-reference"><a href="#footnote-Fadlallah2013" id="citeref-Fadlallah2013">[Fadlallah2013]</a></sup>.</p><p><strong>Estimation</strong></p><p><strong>Univariate time series</strong></p><p>To estimate probabilities or entropies from univariate time series, use the following methods:</p><ul><li><code>probabilities(x::AbstractVector, est::SymbolicWeightedPermutation)</code>. Constructs state vectors    from <code>x</code> using embedding lag <code>τ</code> and embedding dimension <code>m</code>. The ordinal patterns of the    state vectors are then symbolized, and probabilities are taken as the (weighted) relative    frequency of symbols.</li><li><code>genentropy(x::AbstractVector, est::SymbolicWeightedPermutation; α=1, base = 2)</code> computes   weighted probabilities by calling <code>probabilities(x::AbstractVector, est::SymbolicPermutation)</code>,   then computer the order-<code>α</code> generalized entropy to the given base.</li></ul><p>See below for in-place versions below allow you to provide a pre-allocated symbol array <code>s</code> for faster repeated computations of input data of the same length.</p><div class="admonition is-info"><header class="admonition-header">Default embedding dimension and embedding lag</header><div class="admonition-body"><p>By default, embedding dimension <span>$m = 3$</span> with embedding lag <span>$\tau = 1$</span> is used when embedding a time series for symbolization. You should probably make a more informed decision about embedding parameters when computing the permutation entropy of a real time series. In all cases, <span>$m$</span> must be at least 2 (there are no permutations of a single-element state vector, so need <span>$m \geq 2$</span>).</p></div></div><p><strong>Multivariate datasets</strong></p><p>As for regular permutation entropy, numerically speaking, weighted permutation entropy  can also be computed for multivariate datasets with dimension ≥ 2. Such datasets may be, for example, preembedded time series. Then, just skip the delay  reconstruction step, compute and symbols directly from the <span>$L$</span> existing state vectors  <span>$\{\mathbf{x}_1, \mathbf{x}_2, \ldots, \mathbf{x_L}\}$</span>.</p><ul><li><code>probabilities(x::Dataset, est::SymbolicWeightedPermutation)</code>. Compute ordinal patterns of the    state vectors of <code>x</code> directly (without doing any embedding), symbolize those patterns,   and compute probabilities as relative frequencies of symbols.</li><li><code>genentropy(x::Dataset, est::SymbolicWeightedPermutation)</code>. Computes probabilities from    symbol frequencies using <code>probabilities(x::Dataset, est::SymbolicWeightedPermutation)</code>,   then computes the order-<code>α</code> generalized (permutation) entropy to the given base.</li></ul><div class="admonition is-category-warn"><header class="admonition-header">Dynamical interpretation</header><div class="admonition-body"><p>A dynamical interpretation of the permutation entropy does not necessarily hold if computing it on generic multivariate datasets. Method signatures for <code>Dataset</code>s are provided for convenience, and should only be applied if you understand the relation between your input data, the numerical value for the permutation entropy, and its interpretation.</p></div></div><p><strong>Description</strong></p><p><strong>Embedding, ordinal patterns and symbolization</strong></p><p>Consider the <span>$n$</span>-element univariate time series <span>$\{x(t) = x_1, x_2, \ldots, x_n\}$</span>. Let <span>$\mathbf{x_i}^{m, \tau} = \{x_j, x_{j+\tau}, \ldots, x_{j+(m-1)\tau}\}$</span> for <span>$j = 1, 2, \ldots n - (m-1)\tau$</span> be the <span>$i$</span>-th state vector in a delay reconstruction with embedding dimension <span>$m$</span> and reconstruction lag <span>$\tau$</span>. There are then <span>$N = n - (m-1)\tau$</span> state vectors.</p><p>For an <span>$m$</span>-dimensional vector, there are <span>$m!$</span> possible ways of sorting it in ascending order of magnitude. Each such possible sorting ordering is called a <em>motif</em>. Let <span>$\pi_i^{m, \tau}$</span> denote the motif associated with the <span>$m$</span>-dimensional state vector <span>$\mathbf{x_i}^{m, \tau}$</span>, and let <span>$R$</span> be the number of distinct motifs that can be constructed from the <span>$N$</span> state vectors. Then there are at most <span>$R$</span> motifs; <span>$R = N$</span> precisely when all motifs are unique, and <span>$R = 1$</span> when all motifs are the same. Each unique motif <span>$\pi_i^{m, \tau}$</span> can be mapped to a unique integer symbol <span>$0 \leq s_i \leq M!-1$</span>. Let <span>$S(\pi) : \mathbb{R}^m \to \mathbb{N}_0$</span> be the function that maps the motif <span>$\pi$</span> to its symbol <span>$s$</span>, and let <span>$\Pi$</span> denote the set     of symbols <span>$\Pi = \{ s_i \}_{i\in \{ 1, \ldots, R\}}$</span>.</p><p><strong>Probability computation</strong></p><p>Weighted permutation entropy is computed analogously to regular permutation entropy (see <a href="../SymbolicPermutation/#Entropies.SymbolicPermutation"><code>SymbolicPermutation</code></a>), but adds weights that encode amplitude information too:</p><div>\[p(\pi_i^{m, \tau}) = \dfrac{\sum_{k=1}^N \mathbf{1}_{u:S(u) = s_i} 
\left( \mathbf{x}_k^{m, \tau} \right) 
\, w_k}{\sum_{k=1}^N \mathbf{1}_{u:S(u) \in \Pi} 
\left( \mathbf{x}_k^{m, \tau} \right) \,w_k} = \dfrac{\sum_{k=1}^N 
\mathbf{1}_{u:S(u) = s_i} 
\left( \mathbf{x}_k^{m, \tau} \right) \, w_k}{\sum_{k=1}^N w_k}.\]</div><p>The weighted permutation entropy is equivalent to regular permutation entropy when weights are positive and identical (<span>$w_j = \beta \,\,\, \forall \,\,\, j \leq N$</span> and <span>$\beta &gt; 0)$</span>. Weights are dictated by the variance of the state vectors.</p><p>Let the aritmetic mean of state vector <span>$\mathbf{x}_i$</span> be denoted by</p><div>\[\mathbf{\hat{x}}_j^{m, \tau} = \frac{1}{m} \sum_{k=1}^m x_{j + (k+1)\tau}.\]</div><p>Weights are then computed as</p><div>\[w_j = \dfrac{1}{m}\sum_{k=1}^m (x_{j+(k+1)\tau} - \mathbf{\hat{x}}_j^{m, \tau})^2.\]</div><div class="admonition is-category-question"><header class="admonition-header">Implementation details</header><div class="admonition-body"><p><em>Note: in equation 7, section III, of the original paper, the authors write</em></p><div>\[w_j = \dfrac{1}{m}\sum_{k=1}^m (x_{j-(k-1)\tau} - \mathbf{\hat{x}}_j^{m, \tau})^2.\]</div><p><em>But given the formula they give for the arithmetic mean, this is <strong>not</strong> the variance of <span>$\mathbf{x}_i$</span>, because the indices are mixed: <span>$x_{j+(k-1)\tau}$</span> in the weights formula, vs. <span>$x_{j+(k+1)\tau}$</span> in the arithmetic mean formula. This seems to imply that amplitude information about previous delay vectors are mixed with mean amplitude information about current vectors. The authors also mix the terms "vector" and "neighboring vector" (but uses the same notation for both), making it hard to interpret whether the sign switch is a typo or intended. Here, we use the notation above, which actually computes the variance for <span>$\mathbf{x}_i$</span></em>.</p></div></div><p><strong>Entropy computation</strong></p><p>The generalized order-<code>α</code> Renyi entropy<sup class="footnote-reference"><a href="#footnote-Rényi1960" id="citeref-Rényi1960">[Rényi1960]</a></sup> can be computed over the probability  distribution of symbols as  <span>$H(m, \tau, \alpha) = \dfrac{\alpha}{1-\alpha} \log  \left( \sum_{j=1}^R p_j^\alpha \right)$</span>. Permutation entropy, as described in  Bandt and Pompe (2002), is just the limiting case as <span>$α \to1$</span>, that is <span>$H(m, \tau) = - \sum_j^R p(\pi_j^{m, \tau}) \ln p(\pi_j^{m, \tau})$</span>.</p><div class="admonition is-category-hint"><header class="admonition-header">Generalized entropy order vs. permutation order</header><div class="admonition-body"><p>Do not confuse the order of the generalized entropy (<code>α</code>) with the order <code>m</code> of the permutation entropy (<code>m</code>, which controls the symbol size). Weighted permutation entropy is usually estimated with <code>α = 1</code>, but the implementation here allows the generalized entropy of any dimension to be computed from the symbol frequency distribution.</p></div></div><p>See also: <a href="../SymbolicPermutation/#Entropies.SymbolicPermutation"><code>SymbolicPermutation</code></a>, <a href="../SymbolicAmplitudeAwarePermutation/#Entropies.SymbolicAmplitudeAwarePermutation"><code>SymbolicAmplitudeAwarePermutation</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/JuliaDynamics/Entropies.jl/blob/7640adfde084620f33d7873fa40a183257bd51b5/src/symbolic/SymbolicWeightedPermutation.jl#L6-L156" target="_blank">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Fadlallah2013"><a class="tag is-link" href="#citeref-Fadlallah2013">Fadlallah2013</a>Fadlallah, Bilal, et al. "Weighted-permutation entropy: A complexity measure for time series incorporating amplitude information." Physical Review E 87.2 (2013): 022911.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../SymbolicPermutation/">« Permutation (symbolic)</a><a class="docs-footer-nextpage" href="../SymbolicAmplitudeAwarePermutation/">Amplitude-aware permutation (symbolic) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 21 November 2020 01:28">Saturday 21 November 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>